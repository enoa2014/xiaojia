# å°å®¶æœåŠ¡ç®¡ç†æ¡Œé¢ç‰ˆï¼ˆWindowsï¼‰

æœ¬ç›®å½•å­˜æ”¾æ¡Œé¢ç‰ˆå·¥ç¨‹ä»£ç ï¼ŒåŸºäº Electron + React + SQLite æ„å»ºï¼Œç›®æ ‡æ˜¯åœ¨ Windows ç¯å¢ƒä¸­ç¦»çº¿è¿è¡ŒåŸæœ‰å¾®ä¿¡å°ç¨‹åºçš„æ ¸å¿ƒæµç¨‹ã€‚

## ä¸»è¦ç›®å½•
- `app/main/`: Electron ä¸»è¿›ç¨‹ä»£ç ï¼Œè´Ÿè´£çª—å£ã€IPCã€æ•°æ®åº“åˆå§‹åŒ–ã€‚
- `app/preload/`: é¢„åŠ è½½è„šæœ¬ï¼Œå‘ Renderer æš´éœ²å—æ§ APIã€‚
- `app/renderer/`: å‰ç«¯ç•Œé¢ï¼ˆReact + Viteï¼‰ï¼Œé€æ­¥è¿ç§»å°ç¨‹åºé¡µé¢ã€‚
- `shared/`: æ¡Œé¢ç«¯ä¸å°ç¨‹åºå…±äº«çš„æ¨¡å‹/å¸¸é‡/å·¥å…·ã€‚
- `scripts/`: æ„å»ºã€æ‰“åŒ…ã€åˆå§‹åŒ–æ•°æ®åº“ç­‰è„šæœ¬ã€‚

## å¼€å‘æµç¨‹
```bash
pnpm install                  # ä»åœ¨ä»“åº“æ ¹ç›®å½•æ‰§è¡Œ
pnpm --filter ./windows install
pnpm --filter ./windows dev   # å¯åŠ¨ Viteã€é¢„åŠ è½½ç¼–è¯‘ä¸ Electron ä¸»è¿›ç¨‹
```

> `dev` è„šæœ¬ä¼šå¹¶è¡Œæ‰§è¡Œä¸‰ä¸ªä»»åŠ¡ï¼š
> 1. `vite` è´Ÿè´£å‰ç«¯çƒ­æ›´æ–°ï¼›
> 2. `tsc --watch` ç”Ÿæˆ `dist/preload/index.js`ï¼Œä¾› Electron é¢„åŠ è½½ï¼›
> 3. `tsx` å¯åŠ¨ä¸»è¿›ç¨‹ã€‚è‹¥éœ€å•ç‹¬è°ƒè¯•ï¼Œå¯åˆ†åˆ«è¿è¡Œ `dev:renderer`ã€`dev:preload`ã€`dev:main`ã€‚

ç”Ÿäº§æ„å»ºï¼š
```bash
pnpm --filter ./windows build
pnpm --filter ./windows package    # äº§å‡ºå®‰è£…åŒ…ï¼ˆelectron-builderï¼‰
```

## æ•°æ®åº“å­˜å‚¨
- ä½¿ç”¨ `better-sqlite3` ä¸ Electron ä¸»è¿›ç¨‹ç›´æ¥äº¤äº’ï¼Œæ•°æ®åº“æ–‡ä»¶é»˜è®¤æ”¾åœ¨ `app.getPath('userData')` ä¸‹ã€‚
- `app/main/database.ts` ç°é˜¶æ®µä»…åˆ›å»º `meta` è¡¨ç”¨äºæ¼”ç¤ºï¼›åç»­è¿ç§»æ—¶éœ€åŸºäº `indexes.schema.json` ä¸äº‘å‡½æ•° Schema è®¾è®¡å®Œæ•´çš„è¡¨ç»“æ„ã€‚

## é¡µé¢è¿ç§»å»ºè®®
1. å‚è€ƒ `docs/windows-desktop-plan.md`ï¼Œå…ˆæ¢³ç†å„ä¸šåŠ¡æµç¨‹çš„ä¾èµ–å…³ç³»ã€‚
2. é€é¡µè¿ç§» `miniprogram/pages/*`ï¼š
   - WXML â†’ React JSXï¼›
   - WXSS â†’ CSS Modules/CSS-in-JS æˆ–å…¨å±€æ ·å¼ï¼Œä¼˜å…ˆå¤ç”¨è®¾è®¡ Tokensã€‚
3. å°† `miniprogram/services/api.js` ä¸­çš„ API è°ƒç”¨è½¬æ¢ä¸º `window.api` IPC è°ƒç”¨ï¼Œä¸»è¿›ç¨‹å†…è°ƒç”¨æœ¬åœ°æœåŠ¡æ¨¡å—ã€‚
4. äº‘å‡½æ•°çš„ `service.ts` å¯ç›´æ¥æ”¾å…¥ `shared/` å¹¶è°ƒæ•´æ•°æ®è®¿é—®å±‚ä¸º SQLiteã€‚

## å¾…åŠæ¸…å•
- [ ] å®Œæˆ SQLite è¡¨ç»“æ„è®¾è®¡ä¸è¿ç§»è„šæœ¬ã€‚
- [ ] è¿ç§»æ ¸å¿ƒä¸šåŠ¡é¡µé¢ï¼šæ‚£è€…ã€æ´»åŠ¨ã€æŠ¥åã€æƒé™ç­‰ã€‚
- [ ] æ„å»ºä¸»é¢˜ç³»ç»Ÿï¼Œæ”¯æŒä¸åŒè§’è‰²çš„é…è‰²åˆ‡æ¢ã€‚
- [ ] é›†æˆè‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆVitest/Playwrightï¼‰éªŒè¯å…³é”®æµç¨‹ã€‚

å¦‚éœ€äº†è§£æ•´ä½“è¿ç§»ç­–ç•¥ï¼Œè¯·æŸ¥çœ‹ `../docs/windows-desktop-plan.md`ã€‚

## Ê¾ÀıÊı¾İ
- ÔËĞĞ pnpm --filter ./windows seed:data Ïò±¾µØ SQLite Ğ´ÈëÑİÊ¾¼ÇÂ¼£»½Å±¾»áÇåÀíÒÔ seed- ¿ªÍ·µÄ¾ÉÊı¾İ£¬·½±ãÖØ¸´Ö´ĞĞÑéÖ¤Í³¼ÆÒ³Ãæ¡£
