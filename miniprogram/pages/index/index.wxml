
<view class="nav-header {{theme.headerBg}}">
  <view class="brand">🏠 小家服务中心</view>
  <view class="toolbar">
    <view class="tool notif">
      <text class="icon" bindtap="wip">🔔</text>
      <view wx:if="{{notifications>0}}" class="badge">{{notifications}}</view>
    </view>
    <text class="tool" bindtap="wip">💬</text>
    <text class="tool" bindtap="refreshTap" wx:class="{{isRefreshing?'spin':''}}">🔄</text>
    <text class="tool" bindtap="openRoleSwitcher">🧪</text>
  </view>
  
</view>

<view class="user-status {{theme.userBg}} {{theme.userBorder}}">
  <view class="identity">
    <view class="avatar">{{user.avatar || '👩‍💼'}}</view>
    <view class="meta">
      <view class="name {{theme.text}}">{{user.name}}（{{user.roleName}}）</view>
      <view class="perm">权限：<text class="ok">{{user.permText}}</text></view>
    </view>
  </view>
  <view class="work">
    <view class="today">今日：{{user.todayDone}}/{{user.todayTotal}}</view>
    <view class="time">{{user.now}}</view>
  </view>
</view>

<view class="quick-actions" wx:if="{{!loading}}">
  <block wx:for="{{actions}}" wx:key="key">
    <view class="action-card {{selectedActionKey===item.key?'active':''}}" bindtap="onAction" data-key="{{item.key}}">
      <view class="icon">{{item.icon}}</view>
      <view class="title">{{item.title}}</view>
      <view class="subtitle">{{item.subtitle}}</view>
    </view>
  </block>
</view>

<view class="data-overview" wx:if="{{!loading}}">
  <view class="section-title">本月概况</view>
  <view class="stats-grid">
    <block wx:for="{{stats}}" wx:key="key">
      <view class="stats-card">
        <view class="stats-row">
          <view class="stats-left">
            <view class="label">{{item.label}}</view>
            <view class="value">{{item.value}}</view>
          </view>
          <view class="stats-icon">{{item.icon}}</view>
        </view>
        <view wx:if="{{item.change}}" class="delta {{item.change.indexOf('+')===0?'delta--up':'delta--down'}}">{{item.change}}</view>
      </view>
    </block>
  </view>
</view>

<view class="task-reminders" wx:if="{{!loading}}">
  <view class="task-header">
    <view>📋 待办事项 ({{tasks.length}})</view>
    <view class="link" bindtap="wip">查看全部 〉</view>
  </view>
  <view class="task-list">
    <block wx:for="{{tasks}}" wx:key="id">
      <view class="task-item" style="--priority-color: {{item.color}};">
        <view class="task-title">{{item.title}}</view>
        <view class="task-desc">{{item.desc}}</view>
      </view>
    </block>
  </view>
</view>

<view class="recent-updates" wx:if="{{!loading}}">
  <view class="task-header">
    <view>🕐 最近动态</view>
    <view class="link" bindtap="wip">查看全部 〉</view>
  </view>
  <view class="updates-list">
    <block wx:for="{{updates}}" wx:key="id">
      <view class="update-item">
        <view class="u-icon">🔔</view>
        <view class="u-body">
          <view class="u-title">{{item.text}}</view>
          <view class="u-time">{{item.time}}</view>
        </view>
      </view>
    </block>
  </view>
</view>

<!-- 底部导航提示卡片（已移除按要求） -->
<!-- 骨架屏 -->
<view wx:if="{{loading}}" class="skeleton">
  <view class="sk-qa">
    <view class="sk-card"></view>
    <view class="sk-card"></view>
    <view class="sk-card"></view>
    <view class="sk-card"></view>
  </view>
  <view class="sk-stats">
    <view class="sk-stat"></view>
    <view class="sk-stat"></view>
    <view class="sk-stat"></view>
  </view>
  <view class="sk-tasks">
    <view class="sk-task"></view>
    <view class="sk-task"></view>
    <view class="sk-task"></view>
  </view>
</view>
