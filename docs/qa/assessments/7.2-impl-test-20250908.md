# Implementation Test Report: Story 7.2 导航头与页面内边距统一（P0）

- Date: 2025-09-08
- Story: docs/stories/7.2.header-and-padding-unification.md
- Scope Pages: patients/index, stats/index, services/index, activities/index

## 执行摘要
- 结论：CONCERNS（部分通过）。
- 通过：AC-2、AC-3、AC-4
- 部分：AC-1（部分页面仍在各自 WXSS 中定义 `.nav-header` 基础样式）

## 验收对照
- AC-1 统一导航头（高度/阴影/背景来源）：
  - 发现：`miniprogram/app.wxss` 已定义 `.nav-header` 基础样式与阴影/高度；
    - patients/index.wxss：未自定义 `.nav-header`，仅使用全局样式（良好）。
    - stats/index.wxss：定义了 `.nav-header` 基础样式（重复/应集中至 app）。
    - services/index.wxss：定义了 `.nav-header` 基础样式（重复/应集中至 app）。
    - activities/index.wxss：定义了 `.nav-header` 基础样式（重复/应集中至 app）。
  - 判定：PARTIAL。
- AC-2 统一 `.page` 容器：
  - 发现：`app.wxss` 定义 `.page{ padding:0 24rpx }` 与 `.full-bleed{ margin:0 -24rpx }`；目标页面未覆盖横向 padding，仅在各页追加 `padding-bottom`；导航头均采用 `full-bleed` 抵消。
  - 判定：PASS。
- AC-3 落地到四个入口页：
  - 发现：四个入口页均使用 `class="nav-header {{theme.headerBg}}"`（多数含 `full-bleed`）。
  - 判定：PASS。
- AC-4 主题切换一致：
  - 发现：四页 JS 均调用 `applyThemeByRole(this)`；WXML 绑定 `{{theme.headerBg}}`。
  - 判定：PASS。

## 证据
- 全局样式：`miniprogram/app.wxss`（.page/.full-bleed/.nav-header 定义存在）。
- 页面绑定：
  - patients/index.wxml 第 1–8 行，stats/index.wxml 第 1–10 行，services/index.wxml 第 1–10 行，activities/index.wxml 第 1–5 行。
- 页面局部样式重复：
  - `miniprogram/pages/stats/index.wxss:9` → `.nav-header { ... }`
  - `miniprogram/pages/services/index.wxss:12` → `.nav-header { ... }`
  - `miniprogram/pages/activities/index.wxss`（存在 `.nav-header` 定义）

## 改进建议
1) 将各页的 `.nav-header` 基础样式删除，统一落在 `app.wxss`；页面仅保留差异化内容（如局部块背景/动画）。
2) 确保所有导航容器统一添加 `full-bleed`，并删除历史上为抵消内边距的负外边距片段。
3) 后续页面（非四入口）逐步清理重复 `.page` 定义，避免横向 padding 被覆盖。

## 复现命令
```sh
sed -n '1,220p' miniprogram/app.wxss | sed -n '1,120p'
rg -n "^\\.nav-header\\s*\\{" miniprogram/pages/{patients,stats,services,activities}/index.wxss
sed -n '1,60p' miniprogram/pages/{patients,stats,services,activities}/index.wxml
rg -n "applyThemeByRole\\(this\\)" miniprogram/pages/{patients,stats,services,activities}/index.js
```

## 结论
- Gate 建议：CONCERNS（集中化后复检）。

