# Story 7.2: 导航头与页面内边距统一（P0）

## Status
Done

## Story
作为终端用户，我希望各页面的导航头样式与页面内边距保持一致，这样在不同页面间切换时不会产生视觉跳变，整体体验更专业统一。

## Acceptance Criteria
1. 统一导航头：高度、阴影、背景取自主题（`{{theme.headerBg}}`）或 Tokens；禁止页面各自硬编码渐变/高度。
2. 统一 `.page` 容器：默认 `padding: 0 24rpx`；需要满宽的横幅/图表等元素采用 `margin: 0 -24rpx` 抵消。
3. 至少落地到以下页面并保持一致：`pages/{patients,index}.*/{stats/index,services/index,activities/index}`。
4. 通过 `applyThemeByRole` 的主题色切换后，导航头背景与阴影表现一致且无冲突。

## Tasks / Subtasks
- [ ] 设计并实现统一的导航头样式（AC: 1）
  - [ ] 在 app.wxss 定义 `nav-header` 基础样式 与基于 Tokens 的阴影/高度
  - [ ] 在页面 WXML 使用 `class="nav-header {{theme.headerBg}}"`
- [ ] 统一 `.page` 容器样式（AC: 2）
  - [ ] 在 app.wxss 设定 `.page{ padding:0 24rpx }` 与 `.full-bleed{ margin:0 -24rpx }`
- [ ] 页面改造（AC: 3,4）
  - [ ] patients/index.*
  - [ ] stats/index.*
  - [ ] services/index.*
  - [ ] activities/index.*

## Dev Notes
- 前端主题机制（Source: miniprogram/services/theme.js）：
  - `applyThemeByRole(page)` 会设置 `page.data.theme`，并调用 `wx.setNavigationBarColor`。
- 目录与组件（Source: docs/architecture/01-frontend.md）：
  - 导航头建议为通用结构，样式集中在 `app.wxss`，页面仅绑定 `{{theme.headerBg}}`。
- Tokens/工具类（Source: docs/uiux/design-system/tokens.md）：
  - 导航高度、阴影、颜色均需令牌化，避免硬编码。

### Testing
- 主题切换：切换不同角色（管理员/社工/志愿者/家长），导航头背景统一切换，无页面例外。
- 视觉一致性：四个入口页（档案/服务/活动/统计）导航高度与阴影一致。
- A11y：导航文本对比度合规（Source: docs/uiux/design-system/accessibility.md）。

## Change Log
| Date       | Version | Description                                  | Author |
|------------|---------|----------------------------------------------|--------|
| 2025-09-08 | 0.1     | 初始草案                                     | BMAD   |
| 2025-09-08 | 0.2     | 通过 Story Draft Checklist，状态改为 Approved | BMAD   |
| 2025-09-08 | 1.0     | PO 复核：实现与复检通过（Gate=PASS），状态改为 Done | PO     |

## Dev Agent Record
- Agent Model Used: Sonnet 4
- Debug Log References: 
- Completion Notes List:
  - 在 app.wxss 中实现了统一的导航头样式，使用 Design Tokens 进行一致性管理
  - 为所有目标页面添加了 .page 容器和 .full-bleed 导航头样式
  - 清理了各页面中重复的导航头和容器样式定义，避免样式冲突
  - 确保主页也使用了统一的主题切换系统 (applyThemeByRole)
  - 所有页面现在使用相同的导航头高度、阴影和主题色切换机制
  - QA修复：统一了导航头子元素样式（.brand、.nav-actions、.nav-tool）到app.wxss
  - QA修复：彻底清理了各页面残留的重复导航头样式定义
  - QA修复：确保字体大小、间距等细节完全一致，消除视觉差异
- File List:
  - miniprogram/app.wxss: 新增统一的 .nav-header、.page 容器样式和导航头子元素样式
  - miniprogram/pages/index/index.wxml: 添加 .page 容器和 full-bleed 导航头
  - miniprogram/pages/index/index.wxss: 彻底清理重复的导航头相关样式
  - miniprogram/pages/index/index.js: 添加主题系统调用
  - miniprogram/pages/patients/index.wxml: 添加 full-bleed 导航头
  - miniprogram/pages/patients/index.wxss: 彻底清理重复的导航头相关样式
  - miniprogram/pages/stats/index.wxml: 添加 full-bleed 导航头
  - miniprogram/pages/stats/index.wxss: 彻底清理重复的导航头相关样式
  - miniprogram/pages/services/index.wxml: 统一容器类名并添加 full-bleed 导航头
  - miniprogram/pages/services/index.wxss: 彻底清理重复的导航头相关样式
  - miniprogram/pages/activities/index.wxml: 统一容器类名并添加 full-bleed 导航头
  - miniprogram/pages/activities/index.wxss: 彻底清理重复的导航头相关样式 

## QA Results
- Review: docs/qa/reports/7.2-qa-review-20250908.md（最终 PASS）
- Retest: docs/qa/assessments/7.2-impl-retest-20250908.md（Gate After: PASS）
- Final Verification: docs/qa/assessments/7.2-impl-final-verification-20250908.md
- Gate: docs/qa/gates/7.2-implementation.yml（status: PASS）
