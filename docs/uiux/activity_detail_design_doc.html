<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>小家服务管理小程序-活动详情页详细设计文档</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #1f2937;
            background: #f8fafc;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            min-height: 100vh;
        }
        
        .header {
            text-align: center;
            padding: 40px 0;
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            color: white;
            margin: -20px -20px 40px -20px;
            border-radius: 0 0 20px 20px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
            margin-bottom: 20px;
        }
        
        .meta {
            display: flex;
            justify-content: center;
            gap: 30px;
            font-size: 0.9em;
            flex-wrap: wrap;
        }
        
        .toc {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 40px;
            border: 2px solid #cbd5e1;
        }
        
        .toc h2 {
            color: #1e40af;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        
        .toc ol {
            list-style: none;
            counter-reset: section;
        }
        
        .toc li {
            counter-increment: section;
            margin-bottom: 8px;
        }
        
        .toc li::before {
            content: counter(section) ". ";
            font-weight: 600;
            color: #3b82f6;
        }
        
        .toc a {
            color: #4b5563;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 5px;
            transition: all 0.2s;
        }
        
        .toc a:hover {
            background: white;
            color: #1e40af;
            text-decoration: underline;
        }
        
        .section {
            margin-bottom: 50px;
            scroll-margin-top: 20px;
        }
        
        .section h2 {
            color: #1e40af;
            border-bottom: 3px solid #3b82f6;
            padding-bottom: 10px;
            margin-bottom: 25px;
            font-size: 1.8em;
        }
        
        .section h3 {
            color: #374151;
            margin: 25px 0 15px 0;
            font-size: 1.3em;
        }
        
        .section h4 {
            color: #4b5563;
            margin: 20px 0 10px 0;
            font-size: 1.1em;
        }
        
        .card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            border: 1px solid #e5e7eb;
        }
        
        .card h4 {
            margin-top: 0;
            color: #1f2937;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 8px;
            margin-bottom: 15px;
        }
        
        .highlight-card {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            border: 2px solid #3b82f6;
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
        }
        
        .warning-card {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 2px solid #f59e0b;
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
        }
        
        .success-card {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            border: 2px solid #10b981;
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 20px 0;
        }
        
        .ascii-diagram {
            background: #1f2937;
            color: #f9fafb;
            padding: 25px;
            font-family: 'Courier New', monospace;
            border-radius: 10px;
            overflow-x: auto;
            white-space: pre;
            font-size: 0.9em;
            line-height: 1.4;
            margin: 20px 0;
            border: 2px solid #374151;
        }
        
        .code-block {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 15px 0;
            font-size: 0.9em;
        }
        
        .specs-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .specs-table th {
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        .specs-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .specs-table tr:nth-child(even) {
            background: #f9fafb;
        }
        
        .specs-table tr:hover {
            background: #f1f5f9;
        }
        
        ul, ol {
            margin: 15px 0;
            padding-left: 25px;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        strong {
            color: #1f2937;
            font-weight: 600;
        }
        
        .print-break {
            page-break-before: always;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            margin: 2px 4px;
        }
        
        .status-active { background: #d1fae5; color: #065f46; }
        .status-pending { background: #fef3c7; color: #92400e; }
        .status-completed { background: #dbeafe; color: #1e40af; }
        .status-cancelled { background: #fee2e2; color: #991b1b; }
        
        .download-info {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border: 2px solid #10b981;
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }
            
            .meta {
                flex-direction: column;
                gap: 10px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .download-info {
                display: none;
            }
        }
        
        @media print {
            body {
                background: white;
            }
            
            .download-info {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>小家服务管理小程序</h1>
            <p class="subtitle">活动详情页详细设计文档</p>
            <div class="meta">
                <span><strong>版本:</strong> v3.0</span>
                <span><strong>创建时间:</strong> 2025-09-05</span>
                <span><strong>设计师:</strong> UX设计团队</span>
                <span><strong>项目:</strong> 大病儿童家庭"小家"服务管理小程序</span>
            </div>
        </header>

        <div class="download-info">
            <h3>💾 文档使用说明</h3>
            <p>右键点击页面选择"保存为"或按 Ctrl+S (Windows) / Cmd+S (Mac) 保存此文档到本地。<br>
            也可以按 Ctrl+P (Windows) / Cmd+P (Mac) 打印或保存为PDF格式。</p>
        </div>

        <nav class="toc">
            <h2>📋 目录</h2>
            <ol>
                <li><a href="#overview">文档概述与设计目标</a></li>
                <li><a href="#ia-design">信息架构设计</a></li>
                <li><a href="#page-structure">页面结构设计</a></li>
                <li><a href="#component-design">组件设计规范</a></li>
                <li><a href="#interaction-flow">交互流程设计</a></li>
                <li><a href="#permission-system">权限管理系统</a></li>
                <li><a href="#state-management">状态管理规范</a></li>
                <li><a href="#responsive-design">响应式设计</a></li>
                <li><a href="#accessibility">无障碍设计</a></li>
                <li><a href="#performance">性能优化指导</a></li>
                <li><a href="#development-guide">开发实现指导</a></li>
                <li><a href="#testing-standards">测试标准</a></li>
                <li><a href="#maintenance">维护更新指南</a></li>
                <li><a href="#appendix">附录与参考</a></li>
            </ol>
        </nav>

        <section id="overview" class="section">
            <h2>1. 文档概述与设计目标</h2>

            <h3>设计目标</h3>
            <div class="grid-2">
                <div class="card">
                    <h4>🎯 用户体验目标</h4>
                    <ul>
                        <li><strong>快速理解:</strong> 用户在15秒内了解活动核心信息</li>
                        <li><strong>便捷报名:</strong> 3步内完成活动报名流程</li>
                        <li><strong>信息清晰:</strong> 活动详情结构化展示，减少用户疑问</li>
                        <li><strong>状态同步:</strong> 报名状态实时更新，避免冲突</li>
                        <li><strong>多角色适配:</strong> 根据用户角色差异化展示功能</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4>📈 业务价值目标</h4>
                    <ul>
                        <li><strong>参与提升:</strong> 活动参与率提升至85%以上</li>
                        <li><strong>管理效率:</strong> 活动管理工作量减少60%</li>
                        <li><strong>数据洞察:</strong> 提供完整的活动数据分析</li>
                        <li><strong>资源优化:</strong> 提高活动资源利用率</li>
                        <li><strong>用户满意度:</strong> 活动体验满意度≥4.5分</li>
                    </ul>
                </div>
            </div>

            <h3>设计原则</h3>
            <div class="grid-3">
                <div class="card">
                    <h4>📱 移动优先</h4>
                    <p>基于微信小程序平台特性，优先考虑移动端体验，确保单手操作友好。所有交互元素符合44px最小点击区域要求。</p>
                </div>
                
                <div class="card">
                    <h4>🔒 权限分级</h4>
                    <p>根据用户角色（管理员、社工、志愿者、家长）提供差异化功能和信息展示，确保数据安全和隐私保护。</p>
                </div>
                
                <div class="card">
                    <h4>⚡ 性能优先</h4>
                    <p>页面加载时间控制在2秒内，操作响应时间不超过100ms，支持离线缓存关键信息。</p>
                </div>
            </div>

            <div class="highlight-card">
                <h4>🌟 核心理念</h4>
                <p>让每个家庭都能便捷地参与到关爱大病儿童的活动中来，通过技术手段降低参与门槛，提升活动组织效率，为患儿家庭提供更好的支持服务。</p>
            </div>
        </section>

        <section id="ia-design" class="section">
            <h2>2. 信息架构设计</h2>

            <h3>页面层级关系</h3>
            <div class="ascii-diagram">活动页面架构
├── 活动列表页 (L1-主页面)
│   ├── 搜索筛选组件
│   ├── 活动分类标签
│   ├── 活动卡片列表
│   └── 快速操作按钮(FAB)
│
├── 活动详情页 (L2-核心页面) ⭐
│   ├── 活动基本信息区
│   ├── 活动详细描述区
│   ├── 参与者列表区
│   ├── 评论互动区
│   └── 操作按钮区
│
├── 活动报名页 (L3-表单页面)
│   ├── 报名表单
│   ├── 信息确认
│   └── 支付处理(如需要)
│
└── 活动管理页 (L2-权限页面)
    ├── 创建活动
    ├── 编辑活动
    ├── 参与者管理
    └── 数据统计</div>

            <h3>导航路径设计</h3>
            <table class="specs-table">
                <thead>
                    <tr>
                        <th>起始页面</th>
                        <th>目标页面</th>
                        <th>导航方式</th>
                        <th>用户角色</th>
                        <th>权限要求</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>首页</td>
                        <td>活动列表</td>
                        <td>Tab导航</td>
                        <td>所有用户</td>
                        <td>无</td>
                    </tr>
                    <tr>
                        <td>活动列表</td>
                        <td>活动详情</td>
                        <td>点击卡片</td>
                        <td>所有用户</td>
                        <td>无</td>
                    </tr>
                    <tr>
                        <td>活动详情</td>
                        <td>活动报名</td>
                        <td>报名按钮</td>
                        <td>登录用户</td>
                        <td>实名认证</td>
                    </tr>
                    <tr>
                        <td>我的页面</td>
                        <td>我的活动</td>
                        <td>快捷入口</td>
                        <td>登录用户</td>
                        <td>无</td>
                    </tr>
                    <tr>
                        <td>活动详情</td>
                        <td>活动管理</td>
                        <td>管理按钮</td>
                        <td>管理员/社工</td>
                        <td>管理权限</td>
                    </tr>
                </tbody>
            </table>

            <h3>页面标识规范</h3>
            <div class="card">
                <h4>页面层级标识</h4>
                <div class="code-block">// 页面路径规范
pages/
├── activities/
│   ├── index         // 活动列表页 (L1)
│   ├── detail        // 活动详情页 (L2) ⭐
│   ├── registration  // 活动报名页 (L3)
│   ├── management    // 活动管理页 (L2)
│   └── my-activities // 我的活动页 (L2)

// 导航配置
navigationBarTitleText: "活动详情"
enablePullDownRefresh: true
backgroundColor: "#f8fafc"</div>
            </div>
        </section>

        <section id="page-structure" class="section print-break">
            <h2>3. 页面结构设计</h2>

            <h3>整体布局结构</h3>
            <div class="ascii-diagram">┌─────────────────────────────────────┐ ← 状态栏 (44px)
│  9:41      WiFi  ■■■■  100%        │
├─────────────────────────────────────┤ ← 导航栏 (88rpx)
│ ← 返回   活动详情          ⋯ 更多   │   background: #FFFFFF
│                                     │   color: #1F2937
├─────────────────────────────────────┤ ← 活动头部区 (280rpx)
│ 🏃‍♂️ [进行中] 周末亲子康复训练        │   padding: 32rpx 24rpx
│ 📅 2025-09-06 14:00-17:00          │   background: #F8FAFC
│ 📍 康复中心A厅  👥 12/20 已报名     │   
├─────────────────────────────────────┤ ← 封面图区 (400rpx)
│ 📸 [活动封面图片]                   │   aspect-ratio: 16:9
├─────────────────────────────────────┤ ← 快速信息区 (120rpx)
│ 💰免费活动  🎯适合3-12岁  ⏰3小时   │   background: #FFFFFF
├─────────────────────────────────────┤ ← 详细内容区 (自适应)
│ 📋 活动详情                        │   padding: 32rpx 24rpx
│ 本次康复训练主要针对3-12岁患儿...  │   line-height: 1.6
│                                   │
│ 📋 活动要求                        │
│ • 家长陪同参与                     │
│ • 自备舒适运动服装                  │
│ • 按时签到，不要迟到                │
├─────────────────────────────────────┤ ← 参与者区 (200rpx)
│ 👥 参与者 (12人)        查看全部 > │   background: #F9FAFB
│ [头像] [头像] [头像] [头像] ...     │   
├─────────────────────────────────────┤ ← 评论区 (自适应)
│ 💬 评论交流 (5条)       查看全部 > │   background: #FFFFFF
│ 张妈妈: 上次活动非常好，孩子很开心  │   
├─────────────────────────────────────┤ ← 底部操作区 (96rpx)
│ [分享活动] [加入收藏] [立即报名]     │   position: fixed
└─────────────────────────────────────┘   z-index: 1000</div>

            <h3>区域功能定义</h3>
            <table class="specs-table">
                <thead>
                    <tr>
                        <th>区域名称</th>
                        <th>高度(rpx)</th>
                        <th>主要功能</th>
                        <th>设计要点</th>
                        <th>交互行为</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>导航栏</td>
                        <td>88</td>
                        <td>页面导航、标题展示</td>
                        <td>左返回、右更多菜单</td>
                        <td>返回、分享、举报</td>
                    </tr>
                    <tr>
                        <td>活动头部区</td>
                        <td>280</td>
                        <td>核心信息展示</td>
                        <td>状态、标题、时间、地点</td>
                        <td>状态更新、地点导航</td>
                    </tr>
                    <tr>
                        <td>封面图区</td>
                        <td>400</td>
                        <td>视觉展示</td>
                        <td>16:9比例、懒加载</td>
                        <td>点击预览、长按保存</td>
                    </tr>
                    <tr>
                        <td>快速信息区</td>
                        <td>120</td>
                        <td>关键信息标签</td>
                        <td>价格、年龄、时长</td>
                        <td>信息提示</td>
                    </tr>
                    <tr>
                        <td>详细内容区</td>
                        <td>自适应</td>
                        <td>活动描述、要求</td>
                        <td>富文本、可折叠</td>
                        <td>展开收起、复制文本</td>
                    </tr>
                    <tr>
                        <td>参与者区</td>
                        <td>200</td>
                        <td>参与人员展示</td>
                        <td>头像列表、数量统计</td>
                        <td>查看详情、联系参与者</td>
                    </tr>
                    <tr>
                        <td>评论区</td>
                        <td>自适应</td>
                        <td>用户互动交流</td>
                        <td>评论列表、发布入口</td>
                        <td>点赞、回复、举报</td>
                    </tr>
                    <tr>
                        <td>底部操作区</td>
                        <td>96</td>
                        <td>主要操作按钮</td>
                        <td>固定底部、按钮组合</td>
                        <td>分享、收藏、报名</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="component-design" class="section">
            <h2>4. 组件设计规范</h2>

            <h3>活动头部信息组件</h3>
            <div class="card">
                <h4>ActivityHeader 组件规范</h4>
                <div class="code-block">.activity-header {
  padding: 32rpx 24rpx;
  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
  border-bottom: 1rpx solid #e5e7eb;
}

.activity-status {
  display: inline-block;
  padding: 8rpx 16rpx;
  border-radius: 20rpx;
  font-size: 24rpx;
  font-weight: 600;
  margin-bottom: 16rpx;
}

.status-active { background: #d1fae5; color: #065f46; }
.status-pending { background: #fef3c7; color: #92400e; }
.status-full { background: #fee2e2; color: #991b1b; }
.status-ended { background: #f3f4f6; color: #6b7280; }

.activity-title {
  font-size: 32rpx;
  font-weight: 600;
  color: #1f2937;
  line-height: 1.4;
  margin-bottom: 20rpx;
}

.activity-meta {
  display: flex;
  flex-direction: column;
  gap: 12rpx;
}

.meta-item {
  display: flex;
  align-items: center;
  gap: 12rpx;
  font-size: 26rpx;
  color: #4b5563;
}

.meta-icon {
  width: 32rpx;
  height: 32rpx;
  color: #3b82f6;
}</div>
            </div>

            <h3>活动信息卡片组件</h3>
            <div class="grid-2">
                <div class="card">
                    <h4>快速信息标签</h4>
                    <div class="code-block">.quick-info-tags {
  display: flex;
  gap: 16rpx;
  padding: 24rpx;
  background: #ffffff;
  border-bottom: 1rpx solid #f3f4f6;
}

.info-tag {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8rpx;
  padding: 16rpx;
  background: #f9fafb;
  border-radius: 12rpx;
  border: 1rpx solid #e5e7eb;
}

.tag-icon {
  width: 24rpx;
  height: 24rpx;
  color: #3b82f6;
}

.tag-text {
  font-size: 24rpx;
  color: #374151;
  font-weight: 500;
}</div>
                </div>
                
                <div class="card">
                    <h4>详细描述区域</h4>
                    <div class="code-block">.content-section {
  padding: 32rpx 24rpx;
  background: #ffffff;
}

.section-title {
  font-size: 28rpx;
  font-weight: 600;
  color: #1f2937;
  margin-bottom: 20rpx;
  padding-bottom: 12rpx;
  border-bottom: 2rpx solid #3b82f6;
}

.content-text {
  font-size: 26rpx;
  line-height: 1.6;
  color: #374151;
  margin-bottom: 24rpx;
}

.requirements-list {
  list-style: none;
  padding: 0;
}

.requirement-item {
  display: flex;
  align-items: flex-start;
  gap: 12rpx;
  margin-bottom: 16rpx;
  padding: 12rpx;
  background: #f9fafb;
  border-radius: 8rpx;
}

.requirement-icon {
  width: 20rpx;
  height: 20rpx;
  color: #10b981;
  margin-top: 4rpx;
}</div>
                </div>
            </div>

            <h3>参与者展示组件</h3>
            <div class="card">
                <h4>ParticipantsList 组件</h4>
                <div class="code-block">.participants-section {
  padding: 32rpx 24rpx;
  background: #f9fafb;
  border-top: 1rpx solid #e5e7eb;
}

.participants-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24rpx;
}

.participants-title {
  font-size: 28rpx;
  font-weight: 600;
  color: #1f2937;
}

.view-all-button {
  font-size: 24rpx;
  color: #3b82f6;
  display: flex;
  align-items: center;
  gap: 4rpx;
}

.participants-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 12rpx;
}

.participant-avatar {
  width: 64rpx;
  height: 64rpx;
  border-radius: 50%;
  border: 2rpx solid #ffffff;
  box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.1);
}

.participants-more {
  width: 64rpx;
  height: 64rpx;
  border-radius: 50%;
  background: #e5e7eb;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20rpx;
  color: #6b7280;
}</div>
            </div>

            <h3>底部操作按钮组件</h3>
            <div class="card">
                <h4>ActionButtons 组件</h4>
                <div class="code-block">.bottom-actions {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: #ffffff;
  border-top: 1rpx solid #e5e7eb;
  padding: 16rpx 24rpx;
  padding-bottom: calc(16rpx + env(safe-area-inset-bottom));
  box-shadow: 0 -4rpx 16rpx rgba(0,0,0,0.1);
  z-index: 1000;
}

.actions-container {
  display: flex;
  gap: 16rpx;
  align-items: center;
}

.secondary-action {
  flex: none;
  width: 88rpx;
  height: 64rpx;
  background: #f3f4f6;
  border-radius: 12rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1rpx solid #e5e7eb;
}

.primary-action {
  flex: 1;
  height: 64rpx;
  background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
  color: #ffffff;
  border-radius: 12rpx;
  font-size: 28rpx;
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
}

.primary-action:disabled {
  background: #9ca3af;
  color: #ffffff;
}

.primary-action.loading {
  background: #6b7280;
}</div>
            </div>
        </section>

        <section id="interaction-flow" class="section print-break">
            <h2>5. 交互流程设计</h2>

            <h3>页面进入流程</h3>
            <div class="ascii-diagram">用户进入活动详情页
         ↓
    检查页面参数
         ↓
    ┌─ 参数有效? ─ NO → 显示错误页面 → 返回列表
    │         YES ↓
    │     显示骨架屏
    │         ↓
    │     请求活动数据
    │         ↓
    │    ┌─ 请求成功? ─ NO → 显示错误提示 → 重试按钮
    │    │         YES ↓
    │    │     渲染页面内容
    │    │         ↓
    │    │     检查用户权限
    │    │         ↓
    │    │   ┌─ 有查看权限? ─ NO → 显示权限申请 → 等待审核
    │    │   │         YES ↓
    │    │   │     显示完整内容
    │    │   │         ↓
    │    │   │     更新页面状态
    │    │   │         ↓
    │    │   └──── 加载完成 ────┘
    │    │
    │    └─── 缓存页面数据 ───┘
    │
    └─── 页面交互就绪 ───┘</div>

            <h3>报名交互流程</h3>
            <div class="card">
                <h4>报名按钮点击流程</h4>
                <div class="code-block">// 报名交互流程
function handleRegistration() {
  // 1. 检查用户登录状态
  if (!userStore.isLoggedIn) {
    showLoginModal();
    return;
  }
  
  // 2. 检查用户权限
  if (!userStore.hasPermission('activity_register')) {
    showPermissionRequest();
    return;
  }
  
  // 3. 检查活动状态
  if (activity.status !== 'active') {
    showToast('活动已结束或未开始');
    return;
  }
  
  // 4. 检查报名人数
  if (activity.currentParticipants >= activity.maxParticipants) {
    showWaitlistDialog();
    return;
  }
  
  // 5. 跳转报名页面
  wx.navigateTo({
    url: `/pages/activities/registration?id=${activity.id}`
  });
}</div>
            </div>

            <h3>状态变化交互</h3>
            <table class="specs-table">
                <thead>
                    <tr>
                        <th>触发操作</th>
                        <th>状态变化</th>
                        <th>UI反馈</th>
                        <th>后续动作</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>页面下拉刷新</td>
                        <td>loading → updated</td>
                        <td>下拉动画 + 数据更新</td>
                        <td>自动收起刷新控件</td>
                    </tr>
                    <tr>
                        <td>点击报名按钮</td>
                        <td>idle → loading → success</td>
                        <td>按钮loading + 禁用状态</td>
                        <td>跳转报名页面</td>
                    </tr>
                    <tr>
                        <td>活动状态更新</td>
                        <td>实时状态同步</td>
                        <td>状态标签动画变化</td>
                        <td>更新可操作按钮</td>
                    </tr>
                    <tr>
                        <td>收藏/分享操作</td>
                        <td>操作状态切换</td>
                        <td>图标状态变化 + toast</td>
                        <td>更新用户偏好数据</td>
                    </tr>
                </tbody>
            </table>

            <h3>手势交互设计</h3>
            <div class="grid-2">
                <div class="card">
                    <h4>支持的手势操作</h4>
                    <ul>
                        <li><strong>下拉刷新:</strong> 更新活动信息</li>
                        <li><strong>上滑浏览:</strong> 查看详细内容</li>
                        <li><strong>图片双击:</strong> 放大预览</li>
                        <li><strong>长按头像:</strong> 显示用户信息</li>
                        <li><strong>左右滑动:</strong> 切换活动图片</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4>手势反馈效果</h4>
                    <ul>
                        <li><strong>触摸反馈:</strong> 按钮按下态</li>
                        <li><strong>惯性滚动:</strong> 自然滚动体验</li>
                        <li><strong>边界回弹:</strong> 页面边界提示</li>
                        <li><strong>加载反馈:</strong> 数据加载动画</li>
                        <li><strong>操作确认:</strong> 重要操作二次确认</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="permission-system" class="section">
            <h2>6. 权限管理系统</h2>

            <h3>角色权限矩阵</h3>
            <table class="specs-table">
                <thead>
                    <tr>
                        <th>功能模块</th>
                        <th>管理员</th>
                        <th>社工</th>
                        <th>志愿者</th>
                        <th>家长</th>
                        <th>游客</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>查看活动详情</td>
                        <td>✅ 完整信息</td>
                        <td>✅ 完整信息</td>
                        <td>✅ 基础信息</td>
                        <td>✅ 基础信息</td>
                        <td>✅ 公开信息</td>
                    </tr>
                    <tr>
                        <td>报名参与活动</td>
                        <td>✅ 可报名</td>
                        <td>✅ 可报名</td>
                        <td>✅ 可报名</td>
                        <td>✅ 可报名</td>
                        <td>❌ 需要登录</td>
                    </tr>
                    <tr>
                        <td>查看参与者信息</td>
                        <td>✅ 详细信息</td>
                        <td>✅ 详细信息</td>
                        <td>✅ 脱敏信息</td>
                        <td>❌ 需要申请</td>
                        <td>❌ 无权限</td>
                    </tr>
                    <tr>
                        <td>编辑活动信息</td>
                        <td>✅ 全部权限</td>
                        <td>✅ 负责活动</td>
                        <td>❌ 无权限</td>
                        <td>❌ 无权限</td>
                        <td>❌ 无权限</td>
                    </tr>
                    <tr>
                        <td>取消/删除活动</td>
                        <td>✅ 全部权限</td>
                        <td>✅ 负责活动</td>
                        <td>❌ 无权限</td>
                        <td>❌ 无权限</td>
                        <td>❌ 无权限</td>
                    </tr>
                    <tr>
                        <td>活动数据统计</td>
                        <td>✅ 全部数据</td>
                        <td>✅ 相关数据</td>
                        <td>❌ 无权限</td>
                        <td>❌ 无权限</td>
                        <td>❌ 无权限</td>
                    </tr>
                </tbody>
            </table>

            <h3>权限验证流程</h3>
            <div class="card">
                <h4>权限检查机制</h4>
                <div class="code-block">// 权限验证工具函数
class PermissionManager {
  // 检查页面访问权限
  checkPageAccess(userId, activityId) {
    const userRole = this.getUserRole(userId);
    const activity = this.getActivity(activityId);
    
    // 公开活动所有人可查看基础信息
    if (activity.visibility === 'public') {
      return {
        canView: true,
        level: userRole === 'guest' ? 'basic' : 'standard'
      };
    }
    
    // 私有活动需要权限验证
    if (activity.visibility === 'private') {
      return this.checkPrivateAccess(userId, activityId);
    }
  }
  
  // 检查操作权限
  checkActionPermission(userId, action, activityId) {
    const permissions = {
      'view_details': ['admin', 'social_worker', 'volunteer', 'parent'],
      'register': ['admin', 'social_worker', 'volunteer', 'parent'],
      'edit': ['admin', 'social_worker'],
      'delete': ['admin'],
      'view_participants': ['admin', 'social_worker'],
      'export_data': ['admin']
    };
    
    const userRole = this.getUserRole(userId);
    return permissions[action]?.includes(userRole) || false;
  }
}</div>
            </div>

            <h3>敏感信息脱敏规则</h3>
            <div class="grid-2">
                <div class="card">
                    <h4>用户信息脱敏</h4>
                    <ul>
                        <li><strong>姓名:</strong> 只显示姓氏+*（如：王*）</li>
                        <li><strong>手机号:</strong> 中间4位用*替代</li>
                        <li><strong>身份证:</strong> 只显示前3位和后4位</li>
                        <li><strong>地址:</strong> 只显示到区/县级别</li>
                        <li><strong>病情信息:</strong> 根据角色控制可见性</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4>权限申请流程</h4>
                    <ul>
                        <li><strong>申请入口:</strong> 敏感信息区域显示申请按钮</li>
                        <li><strong>申请表单:</strong> 填写申请理由和用途</li>
                        <li><strong>审核流程:</strong> 社工/管理员审核</li>
                        <li><strong>权限时效:</strong> 临时权限（7天有效）</li>
                        <li><strong>使用记录:</strong> 记录查看日志供审计</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="state-management" class="section print-break">
            <h2>7. 状态管理规范</h2>

            <h3>页面状态定义</h3>
            <div class="card">
                <h4>ActivityDetailState 状态模型</h4>
                <div class="code-block">interface ActivityDetailState {
  // 页面状态
  pageStatus: 'loading' | 'loaded' | 'error' | 'refreshing';
  
  // 活动数据
  activity: {
    id: string;
    title: string;
    description: string;
    status: 'draft' | 'active' | 'full' | 'ongoing' | 'ended' | 'cancelled';
    startTime: Date;
    endTime: Date;
    location: string;
    maxParticipants: number;
    currentParticipants: number;
    images: string[];
    requirements: string[];
    organizer: User;
    participants: User[];
  };
  
  // 用户交互状态
  userActions: {
    isRegistered: boolean;
    isFavorited: boolean;
    registrationStatus: 'none' | 'pending' | 'approved' | 'rejected';
  };
  
  // UI状态
  ui: {
    showFullDescription: boolean;
    currentImageIndex: number;
    showParticipantsModal: boolean;
    showRegistrationModal: boolean;
  };
  
  // 权限状态
  permissions: {
    canRegister: boolean;
    canEdit: boolean;
    canViewParticipants: boolean;
    canExportData: boolean;
  };
}</div>
            </div>

            <h3>状态更新流程</h3>
            <div class="ascii-diagram">状态更新流程
    用户操作
        ↓
    触发Action
        ↓
    更新State
        ↓
    ┌─ 需要API调用? ─ YES → 发送请求 → 等待响应 → 更新State
    │         NO ↓                                    ↓
    │     直接更新UI                              更新UI
    │         ↓                                    ↓
    └──── 组件重新渲染 ←─────────────────────────────┘
              ↓
        用户看到变化</div>

            <h3>关键状态转换</h3>
            <table class="specs-table">
                <thead>
                    <tr>
                        <th>状态类型</th>
                        <th>初始状态</th>
                        <th>中间状态</th>
                        <th>最终状态</th>
                        <th>错误处理</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>页面加载</td>
                        <td>loading</td>
                        <td>fetching</td>
                        <td>loaded</td>
                        <td>error + retry</td>
                    </tr>
                    <tr>
                        <td>活动报名</td>
                        <td>none</td>
                        <td>pending</td>
                        <td>approved</td>
                        <td>rejected + reason</td>
                    </tr>
                    <tr>
                        <td>收藏操作</td>
                        <td>unfavorited</td>
                        <td>updating</td>
                        <td>favorited</td>
                        <td>revert + toast</td>
                    </tr>
                    <tr>
                        <td>权限申请</td>
                        <td>no_permission</td>
                        <td>requesting</td>
                        <td>granted</td>
                        <td>denied + appeal</td>
                    </tr>
                </tbody>
            </table>

            <h3>状态持久化策略</h3>
            <div class="grid-2">
                <div class="card">
                    <h4>本地缓存</h4>
                    <ul>
                        <li><strong>活动基础信息:</strong> localStorage，24小时过期</li>
                        <li><strong>用户偏好:</strong> localStorage，长期保存</li>
                        <li><strong>临时状态:</strong> sessionStorage，会话级别</li>
                        <li><strong>敏感信息:</strong> 内存存储，不持久化</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4>状态同步</h4>
                    <ul>
                        <li><strong>实时更新:</strong> WebSocket推送状态变化</li>
                        <li><strong>轮询检查:</strong> 5分钟检查一次活动状态</li>
                        <li><strong>用户操作:</strong> 立即同步到服务器</li>
                        <li><strong>冲突解决:</strong> 服务器状态优先</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="responsive-design" class="section">
            <h2>8. 响应式设计</h2>

            <h3>屏幕适配方案</h3>
            <table class="specs-table">
                <thead>
                    <tr>
                        <th>设备类型</th>
                        <th>屏幕尺寸</th>
                        <th>布局调整</th>
                        <th>字体大小</th>
                        <th>间距调整</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>小屏手机</td>
                        <td>320-375px</td>
                        <td>单列布局</td>
                        <td>28-30rpx</td>
                        <td>16-20rpx</td>
                    </tr>
                    <tr>
                        <td>标准手机</td>
                        <td>375-414px</td>
                        <td>标准布局</td>
                        <td>30-32rpx</td>
                        <td>20-24rpx</td>
                    </tr>
                    <tr>
                        <td>大屏手机</td>
                        <td>414px+</td>
                        <td>增大间距</td>
                        <td>32-36rpx</td>
                        <td>24-32rpx</td>
                    </tr>
                    <tr>
                        <td>平板横屏</td>
                        <td>768px+</td>
                        <td>双列布局</td>
                        <td>34-38rpx</td>
                        <td>32-48rpx</td>
                    </tr>
                </tbody>
            </table>

            <h3>关键组件适配</h3>
            <div class="card">
                <h4>响应式CSS设计</h4>
                <div class="code-block">/* 基础响应式框架 */
.activity-detail {
  max-width: 750rpx;
  margin: 0 auto;
}

/* 小屏适配 */
@media (max-width: 375px) {
  .activity-header {
    padding: 24rpx 16rpx;
  }
  
  .activity-title {
    font-size: 28rpx;
  }
  
  .quick-info-tags {
    flex-direction: column;
    gap: 12rpx;
  }
}

/* 大屏适配 */
@media (min-width: 414px) {
  .content-section {
    padding: 40rpx 32rpx;
  }
  
  .participants-grid {
    justify-content: flex-start;
  }
  
  .bottom-actions {
    padding: 20rpx 32rpx;
  }
}

/* 平板适配 */
@media (min-width: 768px) {
  .activity-detail {
    display: grid;
    grid-template-columns: 1fr 300px;
    gap: 32rpx;
  }
  
  .sidebar {
    position: sticky;
    top: 20rpx;
  }
}</div>
            </div>

            <h3>触摸交互适配</h3>
            <div class="grid-2">
                <div class="card">
                    <h4>触摸目标规范</h4>
                    <ul>
                        <li><strong>最小点击区域:</strong> 44×44px (88×88rpx)</li>
                        <li><strong>按钮间距:</strong> 至少8px (16rpx)</li>
                        <li><strong>滑动区域:</strong> 至少24px (48rpx)高度</li>
                        <li><strong>手势识别:</strong> 支持单指和双指操作</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4>交互反馈</h4>
                    <ul>
                        <li><strong>触摸反馈:</strong> 按下态+触觉反馈</li>
                        <li><strong>加载状态:</strong> 按钮禁用+loading</li>
                        <li><strong>错误提示:</strong> toast+错误状态</li>
                        <li><strong>成功确认:</strong> 动画+状态更新</li>
                    </ul>
                </div>
            </div>

            <h3>内容自适应策略</h3>
            <div class="card">
                <h4>文本和图片适配</h4>
                <div class="code-block">/* 文本自适应 */
.activity-description {
  font-size: clamp(24rpx, 4vw, 32rpx);
  line-height: 1.6;
  word-break: break-word;
  hyphens: auto;
}

/* 图片响应式 */
.activity-image {
  width: 100%;
  height: auto;
  aspect-ratio: 16/9;
  object-fit: cover;
  border-radius: 12rpx;
}

/* 参与者头像适配 */
.participant-avatar {
  width: clamp(48rpx, 8vw, 72rpx);
  height: clamp(48rpx, 8vw, 72rpx);
  border-radius: 50%;
}

/* 底部按钮适配 */
.bottom-actions {
  padding-bottom: env(safe-area-inset-bottom);
}</div>
            </div>
        </section>

        <section id="accessibility" class="section print-break">
            <h2>9. 无障碍设计</h2>

            <h3>WCAG 2.1 AA标准遵循</h3>
            <div class="grid-2">
                <div class="card">
                    <h4>颜色对比度要求</h4>
                    <ul>
                        <li><strong>正常文本:</strong> 对比度≥4.5:1</li>
                        <li><strong>大文本(18px+):</strong> 对比度≥3:1</li>
                        <li><strong>UI组件:</strong> 对比度≥3:1</li>
                        <li><strong>状态指示:</strong> 不仅依赖颜色区分</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4>键盘导航支持</h4>
                    <ul>
                        <li><strong>Tab键遍历:</strong> 逻辑顺序导航</li>
                        <li><strong>焦点指示:</strong> 清晰的焦点框</li>
                        <li><strong>键盘快捷键:</strong> 常用操作快捷键</li>
                        <li><strong>跳过链接:</strong> 快速跳转到主内容</li>
                    </ul>
                </div>
            </div>

            <h3>屏幕阅读器支持</h3>
            <div class="card">
                <h4>ARIA标签和语义化</h4>
                <div class="code-block"><!-- 活动详情页语义化标记 -->
<main role="main" aria-labelledby="activity-title">
  <header class="activity-header">
    <h1 id="activity-title">{{activity.title}}</h1>
    <div class="activity-status" aria-label="活动状态">
      <span class="status-badge" role="status">{{activity.status}}</span>
    </div>
  </header>
  
  <section class="activity-info" aria-labelledby="info-heading">
    <h2 id="info-heading" class="sr-only">活动基本信息</h2>
    <dl class="info-list">
      <dt>时间</dt>
      <dd aria-label="活动时间">{{activity.time}}</dd>
      <dt>地点</dt>
      <dd aria-label="活动地点">{{activity.location}}</dd>
    </dl>
  </section>
  
  <section class="participants" aria-labelledby="participants-heading">
    <h2 id="participants-heading">参与者</h2>
    <div class="participants-grid" role="list" aria-label="参与者列表">
      <div class="participant" role="listitem" v-for="user in participants">
        <img :alt="`${user.name}的头像`" :src="user.avatar">
      </div>
    </div>
  </section>
  
  <nav class="bottom-actions" role="navigation" aria-label="活动操作">
    <button type="button" aria-describedby="share-desc">分享活动</button>
    <span id="share-desc" class="sr-only">将活动信息分享给其他人</span>
  </nav>
</main></div>
            </div>

            <h3>无障碍交互设计</h3>
            <div class="grid-3">
                <div class="card">
                    <h4>视觉辅助</h4>
                    <ul>
                        <li>高对比度模式</li>
                        <li>字体大小调节</li>
                        <li>色彩识别辅助</li>
                        <li>动画减少选项</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4>听觉辅助</h4>
                    <ul>
                        <li>重要信息文字提示</li>
                        <li>操作结果语音反馈</li>
                        <li>视觉提示替代音频</li>
                        <li>字幕支持(视频)</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4>运动辅助</h4>
                    <ul>
                        <li>大触摸目标</li>
                        <li>长按替代双击</li>
                        <li>手势操作提示</li>
                        <li>操作超时延长</li>
                    </ul>
                </div>
            </div>

            <h3>错误处理和用户引导</h3>
            <div class="card">
                <h4>友好的错误信息</h4>
                <div class="code-block"><!-- 无障碍错误提示示例 -->
<div class="error-message" role="alert" aria-live="polite">
  <h3>操作失败</h3>
  <p>很抱歉，报名过程中遇到了问题。</p>
  <p>错误原因：活动人数已满</p>
  <div class="error-actions">
    <button type="button" aria-describedby="waitlist-desc">
      加入等候名单
    </button>
    <span id="waitlist-desc" class="sr-only">
      当有人取消报名时，我们会优先通知您
    </span>
  </div>
</div>

<!-- 操作指导 -->
<div class="help-text" aria-describedby="help-content">
  <button type="button" aria-expanded="false" aria-controls="help-content">
    需要帮助？
  </button>
  <div id="help-content" class="help-content" hidden>
    <p>如果您在报名过程中遇到困难，可以：</p>
    <ol>
      <li>检查网络连接是否正常</li>
      <li>确认已完成实名认证</li>
      <li>联系工作人员：400-xxx-xxxx</li>
    </ol>
  </div>
</div></div>
            </div>
        </section>

        <section id="performance" class="section">
            <h2>10. 性能优化指导</h2>

            <h3>页面加载优化</h3>
            <div class="grid-2">
                <div class="card">
                    <h4>关键渲染路径优化</h4>
                    <ul>
                        <li><strong>骨架屏:</strong> 首屏快速展示页面结构</li>
                        <li><strong>分层加载:</strong> 基础信息优先，详细内容延迟</li>
                        <li><strong>图片懒加载:</strong> 视口外图片延迟加载</li>
                        <li><strong>代码分割:</strong> 按需加载非核心功能</li>
                        <li><strong>预加载:</strong> 关键资源预先获取</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4>缓存策略</h4>
                    <ul>
                        <li><strong>API缓存:</strong> 活动数据缓存5分钟</li>
                        <li><strong>图片缓存:</strong> 本地缓存优化</li>
                        <li><strong>静态资源:</strong> 长期缓存+版本控制</li>
                        <li><strong>用户偏好:</strong> localStorage持久化</li>
                        <li><strong>离线支持:</strong> 关键数据离线可用</li>
                    </ul>
                </div>
            </div>

            <h3>性能监控指标</h3>
            <table class="specs-table">
                <thead>
                    <tr>
                        <th>性能指标</th>
                        <th>目标值</th>
                        <th>测量方法</th>
                        <th>优化策略</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>首屏加载时间</td>
                        <td>≤2秒</td>
                        <td>Performance API</td>
                        <td>骨架屏+分层加载</td>
                    </tr>
                    <tr>
                        <td>交互响应时间</td>
                        <td>≤100ms</td>
                        <td>用户操作监听</td>
                        <td>防抖+节流+预加载</td>
                    </tr>
                    <tr>
                        <td>内存使用</td>
                        <td>≤50MB</td>
                        <td>Memory API</td>
                        <td>及时清理+对象池</td>
                    </tr>
                    <tr>
                        <td>网络请求数</td>
                        <td>≤10个</td>
                        <td>Network监控</td>
                        <td>请求合并+缓存</td>
                    </tr>
                    <tr>
                        <td>页面大小</td>
                        <td>≤500KB</td>
                        <td>Bundle分析</td>
                        <td>代码压缩+Tree shaking</td>
                    </tr>
                </tbody>
            </table>

            <h3>资源优化策略</h3>
            <div class="card">
                <h4>图片和媒体优化</h4>
                <div class="code-block">// 图片加载优化策略
class ImageOptimizer {
  // 响应式图片加载
  loadResponsiveImage(src, options = {}) {
    const {
      fallback = '/images/placeholder.jpg',
      quality = 'auto',
      format = 'webp,jpg'
    } = options;
    
    return `${src}?q=${quality}&f=${format}&w=${this.getOptimalWidth()}`;
  }
  
  // 懒加载实现
  setupLazyLoading() {
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const img = entry.target;
          img.src = img.dataset.src;
          img.classList.add('loaded');
          observer.unobserve(img);
        }
      });
    });
    
    document.querySelectorAll('img[data-src]').forEach(img => {
      observer.observe(img);
    });
  }
  
  // 预加载关键图片
  preloadCriticalImages(urls) {
    urls.forEach(url => {
      const link = document.createElement('link');
      link.rel = 'preload';
      link.as = 'image';
      link.href = url;
      document.head.appendChild(link);
    });
  }
}</div>
            </div>

            <h3>小程序性能优化</h3>
            <div class="grid-2">
                <div class="card">
                    <h4>包体积优化</h4>
                    <ul>
                        <li><strong>分包加载:</strong> 非核心功能分包</li>
                        <li><strong>资源压缩:</strong> 图片+代码压缩</li>
                        <li><strong>依赖清理:</strong> 移除未使用的库</li>
                        <li><strong>CDN加速:</strong> 静态资源CDN</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4>运行时优化</h4>
                    <ul>
                        <li><strong>setData优化:</strong> 减少频繁更新</li>
                        <li><strong>事件委托:</strong> 减少事件监听器</li>
                        <li><strong>长列表优化:</strong> 虚拟滚动</li>
                        <li><strong>内存管理:</strong> 及时清理定时器</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="development-guide" class="section print-break">
            <h2>11. 开发实现指导</h2>

            <h3>技术栈和架构</h3>
            <div class="card">
                <h4>推荐技术栈</h4>
                <div class="code-block">// 项目技术栈
{
  "framework": "微信小程序原生",
  "stateManagement": "mobx-miniprogram",
  "uiLibrary": "vant-weapp",
  "networking": "wx.request + 拦截器",
  "storage": "wx.storage + encryption",
  "navigation": "wx.navigateTo + 路由管理",
  "testing": "miniprogram-simulate + jest",
  "monitoring": "wxs-performance + 错误上报",
  "cicd": "微信开发者工具CI + 自动化部署"
}</div>
            </div>

            <h3>核心组件实现</h3>
            <div class="card">
                <h4>活动详情页主组件</h4>
                <div class="code-block">// pages/activities/detail.js
import { observable, action } from 'mobx-miniprogram';
import { createStoreBindings } from 'mobx-miniprogram-bindings';
import { activityStore } from '../../stores/activityStore';
import { userStore } from '../../stores/userStore';
import { permissionManager } from '../../utils/permissionManager';

Page({
  data: {
    activity: null,
    loading: true,
    error: null,
    userPermissions: {},
    showFullDescription: false
  },

  onLoad(options) {
    this.activityId = options.id;
    this.createStoreBindings();
    this.loadActivityDetail();
  },

  createStoreBindings() {
    this.storeBindings = createStoreBindings(this, {
      store: activityStore,
      fields: ['activities', 'loading', 'error'],
      actions: ['fetchActivity', 'registerActivity', 'toggleFavorite']
    });
  },

  async loadActivityDetail() {
    try {
      // 1. 加载活动详情
      const activity = await this.fetchActivity(this.activityId);
      
      // 2. 检查用户权限
      const permissions = await permissionManager.checkPermissions(
        userStore.currentUser?.id,
        this.activityId
      );
      
      // 3. 更新页面状态
      this.setData({
        activity,
        userPermissions: permissions,
        loading: false
      });
      
      // 4. 设置页面标题
      wx.setNavigationBarTitle({
        title: activity.title
      });
      
    } catch (error) {
      this.setData({
        error: error.message,
        loading: false
      });
    }
  },

  // 用户交互处理
  onRegisterTap() {
    if (!userStore.isLoggedIn) {
      this.showLoginModal();
      return;
    }
    
    if (!this.data.userPermissions.canRegister) {
      this.showPermissionRequest();
      return;
    }
    
    wx.navigateTo({
      url: `/pages/activities/registration?id=${this.activityId}`
    });
  },

  onShareAppMessage() {
    return {
      title: this.data.activity.title,
      path: `/pages/activities/detail?id=${this.activityId}`,
      imageUrl: this.data.activity.images[0]
    };
  }
});</div>
            </div>

            <h3>数据层设计</h3>
            <div class="grid-2">
                <div class="card">
                    <h4>API服务层</h4>
                    <div class="code-block">// services/activityService.js
class ActivityService {
  async getActivityDetail(id) {
    const response = await api.get(`/activities/${id}`);
    return this.transformActivity(response.data);
  }
  
  async registerActivity(activityId, formData) {
    return await api.post(`/activities/${activityId}/register`, formData);
  }
  
  async getParticipants(activityId, page = 1) {
    const response = await api.get(`/activities/${activityId}/participants`, {
      page,
      size: 20
    });
    return response.data;
  }
  
  transformActivity(rawData) {
    return {
      ...rawData,
      startTime: new Date(rawData.start_time),
      endTime: new Date(rawData.end_time),
      images: rawData.images || ['/images/activity-default.jpg']
    };
  }
}</div>
                </div>
                
                <div class="card">
                    <h4>状态管理Store</h4>
                    <div class="code-block">// stores/activityStore.js
import { observable, action } from 'mobx-miniprogram';

export const activityStore = observable({
  activities: new Map(),
  loading: false,
  error: null,

  async fetchActivity(id) {
    this.loading = true;
    try {
      const activity = await activityService.getActivityDetail(id);
      this.activities.set(id, activity);
      return activity;
    } catch (error) {
      this.error = error.message;
      throw error;
    } finally {
      this.loading = false;
    }
  },

  async registerActivity(activityId, formData) {
    try {
      await activityService.registerActivity(activityId, formData);
      const activity = this.activities.get(activityId);
      if (activity) {
        activity.currentParticipants += 1;
        activity.userRegistered = true;
      }
    } catch (error) {
      throw error;
    }
  }
});</div>
                </div>
            </div>

            <h3>错误处理和日志</h3>
            <div class="card">
                <h4>统一错误处理</h4>
                <div class="code-block">// utils/errorHandler.js
class ErrorHandler {
  static handle(error, context = '') {
    // 错误分类
    const errorType = this.classifyError(error);
    
    // 记录日志
    this.logError(error, context, errorType);
    
    // 用户提示
    this.showUserFriendlyMessage(errorType);
    
    // 错误上报
    this.reportError(error, context);
  }
  
  static classifyError(error) {
    if (error.code >= 400 && error.code < 500) {
      return 'CLIENT_ERROR';
    } else if (error.code >= 500) {
      return 'SERVER_ERROR';
    } else if (error.message.includes('timeout')) {
      return 'TIMEOUT_ERROR';
    } else if (error.message.includes('network')) {
      return 'NETWORK_ERROR';
    }
    return 'UNKNOWN_ERROR';
  }
  
  static showUserFriendlyMessage(errorType) {
    const messages = {
      'CLIENT_ERROR': '请求参数有误，请检查后重试',
      'SERVER_ERROR': '服务器繁忙，请稍后重试',
      'TIMEOUT_ERROR': '请求超时，请检查网络连接',
      'NETWORK_ERROR': '网络连接异常，请检查网络设置',
      'UNKNOWN_ERROR': '操作失败，请稍后重试'
    };
    
    wx.showToast({
      title: messages[errorType] || messages['UNKNOWN_ERROR'],
      icon: 'none',
      duration: 3000
    });
  }
}</div>
            </div>
        </section>

        <section id="testing-standards" class="section">
            <h2>12. 测试标准</h2>

            <h3>测试策略</h3>
            <div class="grid-3">
                <div class="card">
                    <h4>单元测试</h4>
                    <ul>
                        <li>工具函数测试</li>
                        <li>数据转换逻辑</li>
                        <li>状态管理逻辑</li>
                        <li>权限验证函数</li>
                        <li>覆盖率≥80%</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4>集成测试</h4>
                    <ul>
                        <li>API接口调用</li>
                        <li>页面跳转流程</li>
                        <li>用户交互流程</li>
                        <li>数据持久化</li>
                        <li>错误处理机制</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4>用户验收测试</h4>
                    <ul>
                        <li>关键业务流程</li>
                        <li>多角色权限验证</li>
                        <li>性能基准测试</li>
                        <li>兼容性测试</li>
                        <li>无障碍功能</li>
                    </ul>
                </div>
            </div>

            <h3>测试用例设计</h3>
            <table class="specs-table">
                <thead>
                    <tr>
                        <th>测试场景</th>
                        <th>测试步骤</th>
                        <th>预期结果</th>
                        <th>优先级</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>正常查看活动详情</td>
                        <td>进入页面→加载数据→显示内容</td>
                        <td>页面正常显示，信息完整</td>
                        <td>🔥高</td>
                    </tr>
                    <tr>
                        <td>用户报名流程</td>
                        <td>点击报名→填写表单→提交成功</td>
                        <td>报名成功，状态更新</td>
                        <td>🔥高</td>
                    </tr>
                    <tr>
                        <td>权限验证</td>
                        <td>不同角色访问→权限检查→差异化显示</td>
                        <td>按权限正确显示功能</td>
                        <td>🔥高</td>
                    </tr>
                    <tr>
                        <td>网络异常处理</td>
                        <td>断网状态→操作页面→显示错误</td>
                        <td>友好错误提示+重试选项</td>
                        <td>📊中</td>
                    </tr>
                    <tr>
                        <td>分享功能</td>
                        <td>点击分享→选择平台→分享成功</td>
                        <td>分享内容正确，跳转正常</td>
                        <td>📊中</td>
                    </tr>
                </tbody>
            </table>

            <h3>性能测试标准</h3>
            <div class="card">
                <h4>性能测试检查清单</h4>
                <div class="code-block">// 性能测试脚本示例
describe('活动详情页性能测试', () => {
  test('页面加载时间应小于2秒', async () => {
    const startTime = Date.now();
    await page.goto('/pages/activities/detail?id=123');
    await page.waitForSelector('.activity-title');
    const loadTime = Date.now() - startTime;
    expect(loadTime).toBeLessThan(2000);
  });
  
  test('滚动性能应流畅', async () => {
    await page.goto('/pages/activities/detail?id=123');
    const fps = await page.evaluate(() => {
      return new Promise(resolve => {
        let frames = 0;
        const startTime = performance.now();
        
        function countFrames() {
          frames++;
          if (performance.now() - startTime < 1000) {
            requestAnimationFrame(countFrames);
          } else {
            resolve(frames);
          }
        }
        
        page.scrollTo(0, 1000);
        requestAnimationFrame(countFrames);
      });
    });
    
    expect(fps).toBeGreaterThan(30);
  });
  
  test('内存使用应控制在合理范围', async () => {
    const metrics = await page.metrics();
    expect(metrics.JSHeapUsedSize).toBeLessThan(50 * 1024 * 1024); // 50MB
  });
});</div>
            </div>

            <h3>测试自动化</h3>
            <div class="grid-2">
                <div class="card">
                    <h4>CI/CD集成</h4>
                    <ul>
                        <li><strong>代码提交:</strong> 自动运行单元测试</li>
                        <li><strong>构建流程:</strong> 集成测试+性能测试</li>
                        <li><strong>部署前:</strong> 完整回归测试</li>
                        <li><strong>监控告警:</strong> 线上性能监控</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4>测试报告</h4>
                    <ul>
                        <li><strong>覆盖率报告:</strong> 代码覆盖度统计</li>
                        <li><strong>性能报告:</strong> 加载时间+用户体验</li>
                        <li><strong>兼容性报告:</strong> 设备+版本兼容</li>
                        <li><strong>安全测试:</strong> 权限+数据安全</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="maintenance" class="section print-break">
            <h2>13. 维护更新指南</h2>

            <h3>版本管理策略</h3>
            <div class="card">
                <h4>语义化版本控制</h4>
                <div class="code-block">// 版本号格式：主版本.次版本.修订版本
// 例如：v2.1.3

/**
 * 主版本号：不兼容的API修改
 * - 页面结构重大调整
 * - 权限系统重构
 * - 数据格式变更
 */

/**
 * 次版本号：向下兼容的功能新增
 * - 新增交互功能
 * - 新增显示组件
 * - 优化用户体验
 */

/**
 * 修订版本号：向下兼容的bug修复
 * - 修复显示问题
 * - 修复交互bug
 * - 性能优化
 */

// 版本发布流程
{
  "develop": "开发分支 - 日常开发",
  "staging": "测试分支 - 功能测试",
  "release": "发布分支 - 发布准备",
  "master": "主分支 - 生产环境",
  "hotfix": "热修复分支 - 紧急修复"
}</div>
            </div>

            <h3>更新内容规划</h3>
            <table class="specs-table">
                <thead>
                    <tr>
                        <th>更新类型</th>
                        <th>更新周期</th>
                        <th>主要内容</th>
                        <th>影响范围</th>
                        <th>测试要求</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>功能迭代</td>
                        <td>2-4周</td>
                        <td>新功能开发、交互优化</td>
                        <td>用户体验提升</td>
                        <td>完整回归测试</td>
                    </tr>
                    <tr>
                        <td>性能优化</td>
                        <td>4-6周</td>
                        <td>加载速度、响应时间优化</td>
                        <td>系统性能提升</td>
                        <td>性能基准测试</td>
                    </tr>
                    <tr>
                        <td>安全更新</td>
                        <td>即时</td>
                        <td>权限漏洞修复、数据保护</td>
                        <td>安全性增强</td>
                        <td>安全测试认证</td>
                    </tr>
                    <tr>
                        <td>兼容性更新</td>
                        <td>按需</td>
                        <td>新设备适配、系统兼容</td>
                        <td>设备覆盖增加</td>
                        <td>兼容性测试</td>
                    </tr>
                    <tr>
                        <td>Bug修复</td>
                        <td>1-2周</td>
                        <td>功能缺陷修复</td>
                        <td>稳定性提升</td>
                        <td>相关功能测试</td>
                    </tr>
                </tbody>
            </table>

            <h3>监控和反馈</h3>
            <div class="grid-2">
                <div class="card">
                    <h4>关键指标监控</h4>
                    <ul>
                        <li><strong>页面性能:</strong> 加载时间、错误率</li>
                        <li><strong>用户行为:</strong> 页面停留时间、操作成功率</li>
                        <li><strong>业务指标:</strong> 活动报名转化率</li>
                        <li><strong>技术指标:</strong> API响应时间、内存使用</li>
                        <li><strong>错误监控:</strong> 异常频率、错误类型</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4>用户反馈渠道</h4>
                    <ul>
                        <li><strong>应用内反馈:</strong> 意见建议收集</li>
                        <li><strong>用户调研:</strong> 定期体验调研</li>
                        <li><strong>数据分析:</strong> 用户行为分析</li>
                        <li><strong>客服反馈:</strong> 客服问题统计</li>
                        <li><strong>社区反馈:</strong> 用户群体意见</li>
                    </ul>
                </div>
            </div>

            <h3>文档维护</h3>
            <div class="success-card">
                <h4>📚 文档更新机制</h4>
                <ul>
                    <li><strong>设计规范:</strong> 每次UI改动后更新设计文档</li>
                    <li><strong>API文档:</strong> 接口变更时同步更新</li>
                    <li><strong>用户手册:</strong> 功能更新后更新操作指南</li>
                    <li><strong>开发文档:</strong> 技术架构变更时更新</li>
                    <li><strong>测试用例:</strong> 新功能开发时补充测试案例</li>
                </ul>
            </div>

            <h3>代码质量保证</h3>
            <div class="card">
                <h4>代码审查标准</h4>
                <div class="code-block">// 代码审查检查清单
const codeReviewChecklist = {
  // 功能性检查
  functionality: [
    '功能是否按需求正确实现',
    '边界条件是否正确处理',
    '错误处理是否完善',
    '性能是否满足要求'
  ],
  
  // 代码质量检查
  quality: [
    '代码结构是否清晰',
    '命名是否有意义',
    '注释是否充分',
    '是否遵循编码规范'
  ],
  
  // 安全性检查
  security: [
    '是否存在安全漏洞',
    '输入验证是否充分',
    '权限控制是否正确',
    '敏感信息是否保护'
  ],
  
  // 可维护性检查
  maintainability: [
    '代码是否易于理解',
    '模块化是否合理',
    '测试覆盖是否充分',
    '文档是否完整'
  ]
};</div>
            </div>

            <h3>发布流程管理</h3>
            <div class="grid-2">
                <div class="card">
                    <h4>发布前检查</h4>
                    <ul>
                        <li>✅ 功能测试通过</li>
                        <li>✅ 性能测试达标</li>
                        <li>✅ 安全审计通过</li>
                        <li>✅ 兼容性验证</li>
                        <li>✅ 文档更新完成</li>
                        <li>✅ 回滚方案准备</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4>发布后监控</h4>
                    <ul>
                        <li>📊 实时性能监控</li>
                        <li>📊 错误率统计</li>
                        <li>📊 用户反馈收集</li>
                        <li>📊 业务指标跟踪</li>
                        <li>📊 系统稳定性监控</li>
                        <li>📊 资源使用情况</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="appendix" class="section print-break">
            <h2>14. 附录与参考</h2>

            <h3>设计资源</h3>
            <div class="grid-2">
                <div class="card">
                    <h4>🎨 设计文件清单</h4>
                    <ul>
                        <li><strong>活动详情页设计稿:</strong> activity-detail-design.fig</li>
                        <li><strong>组件设计规范:</strong> component-library.fig</li>
                        <li><strong>交互原型:</strong> activity-flow-prototype.rp</li>
                        <li><strong>图标资源:</strong> icon-library.svg</li>
                        <li><strong>多状态设计:</strong> state-variations.fig</li>
                        <li><strong>响应式适配:</strong> responsive-layouts.fig</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4>📱 技术文档</h4>
                    <ul>
                        <li><strong>API接口文档:</strong> activity-api-spec.md</li>
                        <li><strong>数据库设计:</strong> activity-db-schema.sql</li>
                        <li><strong>权限配置:</strong> permission-config.json</li>
                        <li><strong>部署指南:</strong> deployment-guide.md</li>
                        <li><strong>测试方案:</strong> test-plan.md</li>
                        <li><strong>性能基准:</strong> performance-benchmark.md</li>
                    </ul>
                </div>
            </div>

            <h3>外部参考标准</h3>
            <table class="specs-table">
                <thead>
                    <tr>
                        <th>参考标准</th>
                        <th>版本</th>
                        <th>应用领域</th>
                        <th>关键要求</th>
                        <th>官方链接</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>微信小程序设计指南</td>
                        <td>v2024</td>
                        <td>界面设计、交互规范</td>
                        <td>符合微信生态规范</td>
                        <td>developers.weixin.qq.com</td>
                    </tr>
                    <tr>
                        <td>WCAG 2.1 AA</td>
                        <td>2.1</td>
                        <td>无障碍设计</td>
                        <td>对比度、键盘导航</td>
                        <td>w3.org/WAI/WCAG21</td>
                    </tr>
                    <tr>
                        <td>Material Design</td>
                        <td>v3</td>
                        <td>组件设计、动效</td>
                        <td>现代化UI设计</td>
                        <td>material.io</td>
                    </tr>
                    <tr>
                        <td>Apple HIG</td>
                        <td>2024</td>
                        <td>iOS设计规范</td>
                        <td>触摸交互、视觉层次</td>
                        <td>developer.apple.com</td>
                    </tr>
                    <tr>
                        <td>ISO 9241-11</td>
                        <td>2018</td>
                        <td>可用性评估</td>
                        <td>用户体验测量</td>
                        <td>iso.org</td>
                    </tr>
                </tbody>
            </table>

            <h3>术语表</h3>
            <div class="card">
                <h4>专业术语定义</h4>
                <div class="code-block">术语表 (Glossary)

活动详情页 (Activity Detail Page)
  显示单个活动完整信息的页面，包括基础信息、详细描述、参与者列表等

权限分级 (Permission Tiering)
  根据用户角色提供不同级别的功能访问权限和信息可见性

脱敏显示 (Data Masking)
  对敏感信息进行部分隐藏或替换，保护用户隐私

响应式设计 (Responsive Design)
  页面能够适应不同屏幕尺寸和设备的设计方法

无障碍设计 (Accessibility Design)
  确保所有用户(包括残障人士)都能正常使用的设计原则

状态管理 (State Management)
  统一管理应用程序中的数据状态和UI状态

组件化开发 (Component-based Development)
  将UI拆分为独立、可复用的组件进行开发

性能优化 (Performance Optimization)
  通过各种技术手段提升应用程序的运行效率

用户体验 (User Experience, UX)
  用户在使用产品过程中的整体感受和体验

交互设计 (Interaction Design)
  定义用户与产品之间交互方式的设计过程</div>
            </div>

            <h3>版本历史</h3>
            <table class="specs-table">
                <thead>
                    <tr>
                        <th>版本</th>
                        <th>日期</th>
                        <th>更新内容</th>
                        <th>负责人</th>
                        <th>状态</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>v1.0</td>
                        <td>2025-08-15</td>
                        <td>初始版本，基础设计规范</td>
                        <td>UX设计团队</td>
                        <td class="status-completed">已完成</td>
                    </tr>
                    <tr>
                        <td>v2.0</td>
                        <td>2025-09-01</td>
                        <td>新增权限管理、无障碍设计</td>
                        <td>产品设计团队</td>
                        <td class="status-completed">已完成</td>
                    </tr>
                    <tr>
                        <td>v2.1</td>
                        <td>2025-09-03</td>
                        <td>优化交互流程、性能指标</td>
                        <td>交互设计师</td>
                        <td class="status-completed">已完成</td>
                    </tr>
                    <tr>
                        <td>v3.0</td>
                        <td>2025-09-05</td>
                        <td>完整的开发实现指导</td>
                        <td>技术团队</td>
                        <td class="status-active">当前版本</td>
                    </tr>
                    <tr>
                        <td>v3.1</td>
                        <td>2025-09-15</td>
                        <td>测试标准、维护指南补充</td>
                        <td>QA团队</td>
                        <td class="status-pending">计划中</td>
                    </tr>
                </tbody>
            </table>

            <h3>团队协作信息</h3>
            <div class="grid-2">
                <div class="card">
                    <h4>👥 项目团队</h4>
                    <ul>
                        <li><strong>产品负责人:</strong> 张经理 - 需求确认和优先级</li>
                        <li><strong>UX设计师:</strong> 李设计 - 用户体验设计</li>
                        <li><strong>UI设计师:</strong> 王设计 - 视觉界面设计</li>
                        <li><strong>前端开发:</strong> 陈工程师 - 小程序开发</li>
                        <li><strong>后端开发:</strong> 刘工程师 - API接口开发</li>
                        <li><strong>测试工程师:</strong> 赵测试 - 质量保证</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4>📞 联系方式</h4>
                    <ul>
                        <li><strong>项目群:</strong> 小家服务设计群</li>
                        <li><strong>邮件列表:</strong> xiaojia-design@company.com</li>
                        <li><strong>文档仓库:</strong> git.company.com/xiaojia/docs</li>
                        <li><strong>设计文件:</strong> figma.com/xiaojia-design</li>
                        <li><strong>项目管理:</strong> jira.company.com/xiaojia</li>
                        <li><strong>会议时间:</strong> 每周三 14:00 设计评审</li>
                    </ul>
                </div>
            </div>

            <h3>相关文档链接</h3>
            <div class="highlight-card">
                <h4>📄 相关设计文档</h4>
                <ul>
                    <li><strong>《小家服务管理小程序-整体设计规范》:</strong> 全局设计标准和规范</li>
                    <li><strong>《活动列表页设计文档》:</strong> 活动列表页面的详细设计</li>
                    <li><strong>《活动报名页设计文档》:</strong> 报名流程页面设计</li>
                    <li><strong>《用户权限管理系统设计》:</strong> 权限系统设计规范</li>
                    <li><strong>《小程序性能优化指南》:</strong> 性能优化最佳实践</li>
                    <li><strong>《无障碍设计实施手册》:</strong> 无障碍功能实现指导</li>
                </ul>
            </div>

            <h3>常见问题FAQ</h3>
            <div class="card">
                <h4>❓ 设计实施常见问题</h4>
                
                <h5>Q: 活动状态变更时，页面如何实时更新？</h5>
                <p><strong>A:</strong> 采用WebSocket长连接+定时轮询的混合方案。关键状态变更通过WebSocket立即推送，其他状态每5分钟轮询一次确保数据一致性。</p>
                
                <h5>Q: 不同角色用户看到的页面差异如何实现？</h5>
                <p><strong>A:</strong> 通过权限配置文件定义各角色可见组件和功能，页面渲染时根据用户角色动态显示/隐藏相应内容。敏感信息采用服务端脱敏。</p>
                
                <h5>Q: 如何保证页面在弱网环境下的可用性？</h5>
                <p><strong>A:</strong> 实施多层缓存策略：关键数据离线缓存、图片懒加载、请求失败自动重试、降级显示策略。提供离线模式基础功能。</p>
                
                <h5>Q: 活动报名人数实时更新如何避免超员？</h5>
                <p><strong>A:</strong> 采用乐观锁+服务端最终验证机制。前端显示实时人数，报名时服务端进行最终库存校验，超员时提供候补队列选项。</p>
                
                <h5>Q: 页面性能如何监控和优化？</h5>
                <p><strong>A:</strong> 集成性能监控SDK，监控关键指标（加载时间、内存使用、用户操作响应时间）。设置告警阈值，定期生成性能报告指导优化工作。</p>
            </div>

            <h3>更新计划</h3>
            <div class="warning-card">
                <h4>🔄 后续版本规划</h4>
                <ul>
                    <li><strong>v3.1 (2025年9月):</strong> 增加活动评价功能、优化图片加载性能</li>
                    <li><strong>v3.2 (2025年10月):</strong> 支持活动直播功能、增强分享能力</li>
                    <li><strong>v4.0 (2025年11月):</strong> 重构权限系统、引入AI智能推荐</li>
                    <li><strong>v4.1 (2025年12月):</strong> 多语言支持、国际化适配</li>
                </ul>
            </div>
        </section>

        <footer style="margin-top: 60px; padding: 40px 0; border-top: 2px solid #f1f5f9; background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);">
            <div style="text-align: center;">
                <h3 style="color: #1e293b; margin-bottom: 15px;">📋 文档总结</h3>
                <p style="margin-bottom: 20px; line-height: 1.6; max-width: 800px; margin-left: auto; margin-right: auto;">
                    本文档详细定义了小家服务管理小程序活动详情页的完整设计规范，涵盖了从用户体验设计到技术实现的全过程。
                    通过角色差异化设计、权限精细控制和数据安全脱敏，确保不同角色用户都能便捷、安全地查看和参与活动。
                    文档遵循微信小程序设计规范和无障碍设计标准，为开发团队提供了详细的实施指导。
                </p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 30px 0;">
                    <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <h4 style="color: #3b82f6; margin-bottom: 10px;">🎯 核心目标</h4>
                        <p style="font-size: 14px; color: #6b7280;">提升用户体验，优化活动参与流程，确保信息安全</p>
                    </div>
                    <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <h4 style="color: #10b981; margin-bottom: 10px;">✅ 设计原则</h4>
                        <p style="font-size: 14px; color: #6b7280;">移动优先，权限分级，性能优先，无障碍友好</p>
                    </div>
                    <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <h4 style="color: #f59e0b; margin-bottom: 10px;">🔧 技术规范</h4>
                        <p style="font-size: 14px; color: #6b7280;">组件化开发，状态管理，性能监控，安全保护</p>
                    </div>
                    <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <h4 style="color: #ef4444; margin-bottom: 10px;">📊 质量保证</h4>
                        <p style="font-size: 14px; color: #6b7280;">全面测试，持续监控，版本管理，文档维护</p>
                    </div>
                </div>
                
                <div style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); padding: 25px; border-radius: 15px; margin: 30px 0; border: 2px solid #3b82f6;">
                    <h4 style="color: #1e40af; margin-bottom: 15px;">🚀 实施建议</h4>
                    <div style="text-align: left; max-width: 600px; margin: 0 auto;">
                        <ol style="color: #1e40af; line-height: 1.8;">
                            <li>按照设计规范逐步实施，确保每个组件都符合标准</li>
                            <li>重点关注权限管理和数据安全，保护用户隐私</li>
                            <li>持续进行性能优化，确保用户体验流畅</li>
                            <li>建立完善的测试流程，保证功能稳定可靠</li>
                            <li>定期收集用户反馈，持续改进产品体验</li>
                        </ol>
                    </div>
                </div>
                
                <div style="color: #6b7280; font-size: 14px; margin-top: 30px;">
                    <p><strong>文档版本:</strong> v3.0 | <strong>最后更新:</strong> 2025年9月5日</p>
                    <p><strong>设计团队:</strong> 小家服务UX设计团队 | <strong>技术支持:</strong> 前端开发团队</p>
                    <p style="margin-top: 15px;">
                        <em>本文档为小家服务管理小程序活动详情页设计的官方指导文档，<br>
                        请在实施过程中严格遵循相关规范，如有疑问请联系设计团队。</em>
                    </p>
                </div>
            </div>
        </footer>
    </div>
</body>
</html>
                