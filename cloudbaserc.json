{
  "version": "2.0",
  "envId": "cloud1-3grb87gwaba26b64",
  "framework": {
    "name": "xiaojia",
    "plugins": [
      {
        "name": "function",
        "use": "@cloudbase/framework-plugin-function",
        "inputs": {
          "functionRootPath": "functions",
          "functions": [
            {
              "name": "patients",
              "timeout": 60,
              "envVariables": {},
              "runtime": "Nodejs16.13",
              "installDependency": true
            },
            {
              "name": "services", 
              "timeout": 60,
              "envVariables": {},
              "runtime": "Nodejs16.13",
              "installDependency": true
            },
            {
              "name": "activities",
              "timeout": 60,
              "envVariables": {},
              "runtime": "Nodejs16.13", 
              "installDependency": true
            },
            {
              "name": "permissions",
              "timeout": 60,
              "envVariables": {},
              "runtime": "Nodejs16.13",
              "installDependency": true
            },
            {
              "name": "registrations",
              "timeout": 60,
              "envVariables": {},
              "runtime": "Nodejs16.13",
              "installDependency": true
            },
            {
              "name": "tenancies",
              "timeout": 60,
              "envVariables": {},
              "runtime": "Nodejs16.13",
              "installDependency": true
            },
            {
              "name": "users",
              "timeout": 60,
              "envVariables": {},
              "runtime": "Nodejs16.13",
              "installDependency": true
            },
            {
              "name": "exports",
              "timeout": 60,
              "envVariables": {},
              "runtime": "Nodejs16.13",
              "installDependency": true
            },
            {
              "name": "stats",
              "timeout": 60,
              "envVariables": {},
              "runtime": "Nodejs16.13",
              "installDependency": true
            },
            {
              "name": "import-xlsx",
              "timeout": 120,
              "envVariables": {},
              "runtime": "Nodejs16.13",
              "installDependency": true
            },
            {
              "name": "init-db",
              "timeout": 120,
              "envVariables": {},
              "runtime": "Nodejs16.13",
              "installDependency": true
            },
            {
              "name": "relations",
              "timeout": 60,
              "envVariables": {},
              "runtime": "Nodejs16.13",
              "installDependency": true
            }
          ]
        }
      },
      {
        "name": "database",
        "use": "@cloudbase/framework-plugin-database",
        "inputs": {
          "collections": [
            {
              "collectionName": "Patients",
              "indexes": [
                { "name": "idx_id_card", "unique": true, "keys": { "id_card": 1 } },
                { "name": "idx_name_tail", "keys": { "name": 1, "id_card_tail": 1 } },
                { "name": "idx_createdAt", "keys": { "createdAt": -1 } }
              ]
            },
            {
              "collectionName": "Tenancies",
              "indexes": [
                { "name": "idx_idcard_checkin", "keys": { "id_card": 1, "checkInDate": -1 } },
                { "name": "idx_patient_checkin", "keys": { "patientId": 1, "checkInDate": -1 } },
                { "name": "idx_createdAt", "keys": { "createdAt": -1 } }
              ]
            },
            {
              "collectionName": "Services",
              "indexes": [
                { "name": "idx_createdBy_date", "keys": { "createdBy": 1, "date": -1 } },
                { "name": "idx_patient_date",  "keys": { "patientId": 1, "date": -1 } }
              ]
            },
            {
              "collectionName": "Activities",
              "indexes": [
                { "name": "idx_status_date", "keys": { "status": 1, "date": 1 } }
              ]
            },
            {
              "collectionName": "Registrations",
              "indexes": [
                { "name": "uniq_user_activity", "unique": true, "keys": { "userId": 1, "activityId": 1 } },
                { "name": "idx_activity_status", "keys": { "activityId": 1, "status": 1 } }
              ]
            },
            {
              "collectionName": "PermissionRequests",
              "indexes": [
                { "name": "idx_requester_status", "keys": { "requesterId": 1, "status": 1 } },
                { "name": "idx_expiresAt", "keys": { "expiresAt": 1 } }
              ]
            },
            {
              "collectionName": "ExportTasks",
              "indexes": [
                { "name": "idx_status", "keys": { "status": 1 } },
                { "name": "idx_type_createdAt", "keys": { "type": 1, "createdAt": -1 } }
              ]
            },
            {
              "collectionName": "AuditLogs",
              "indexes": [
                { "name": "idx_createdAt", "keys": { "createdAt": -1 } },
                { "name": "idx_actor_createdAt", "keys": { "actorId": 1, "createdAt": -1 } },
                { "name": "idx_action_createdAt", "keys": { "action": 1, "createdAt": -1 } }
              ]
            }
          ]
        }
      }
    ]
  }
}
